"use strict";!function(r,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("react")):"function"==typeof define&&define.amd?define(["exports","react"],e):e((r="undefined"!=typeof globalThis?globalThis:r||self).ReactCoolVirtual={},r.React)}(this,(function(r,e){var n,t;(t=n||(n={})).auto="auto",t.start="start",t.center="center",t.end="end";var u=function(r,e,n,t){for(;r<=e;){var u=(r+e)/2|0,i=t(u);if(n<i)e=u-1;else{if(!(n>i))return u;r=u+1}}return 0<r?r-1:0},i=function(r){return"number"==typeof r&&!Number.isNaN(r)},c=function(){return"performance"in window?performance.now():Date.now()},o=function(r){var n=e.useRef(r);return n.current=r,n},a="undefined"!=typeof window?e.useLayoutEffect:e.useEffect;r.useVirtual=function(r){var t=r.itemCount,s=r.ssrItemCount,f=r.itemSize,l=void 0===f?50:f;f=r.horizontal;var d=r.resetScroll,v=r.overscanCount,h=void 0===v?1:v;v=r.useIsScrolling;var m=r.stickyIndices,g=r.scrollDuration;g=void 0===g?function(r){return Math.min(Math.max(.075*r,100),500)}:g;var b=r.scrollEasingFunction;b=void 0===b?function(r){return-(Math.cos(Math.PI*r)-1)/2}:b;var p=r.loadMoreCount,S=void 0===p?15:p;p=r.isItemLoaded;var R=r.loadMore,x=r.onScroll;r=r.onResize;var M=e.useState((function(){return function(r,e){void 0===e&&(e=0);var n=i(e)?[0,e-1]:e;e=n[1];var t=[];for(n=n[0];n<=e;n+=1)t.push({index:n,start:0,width:0,size:i(r)?r:r(n,0),measureRef:function(){return null}});return{items:t}}(l,s)})),w=M[0],z=M[1],C=e.useRef(!1),y=e.useRef(!0),k=e.useRef(!1),I=e.useRef(!1),A=e.useRef(new Map),F=e.useRef(0),T=e.useRef(-1),O=e.useRef(-1),E=e.useRef(null),L=e.useRef(null),q=e.useRef({width:0,height:0}),j=e.useRef([]),N=e.useRef(!0),D=e.useRef(),P=o(m),V=o(g),_=o(b),B=o(p),G=o(R),H=o(l),J=o(v),K=o(x),Q=o(r),U=f?"width":"height",W=f?"marginLeft":"marginTop",X=f?"scrollLeft":"scrollTop",Y=e.useCallback((function(r){var e=H.current;return i(e)?e:e(r,q.current.width)}),[H]),Z=e.useCallback((function(r,e){var n,t,u=null!=(n=null==(t=j.current[r-1])?void 0:t.end)?n:0;return{idx:r,start:u,end:u+e,size:e}}),[]),$=e.useCallback((function(r){void 0===r&&(r=!0),j.current.length=t;for(var e=0;e<t;e+=1)j.current[e]=Z(e,r&&j.current[e]?j.current[e].size:Y(e))}),[Y,Z,t]),rr=e.useCallback((function(r){var e=j.current,n=e.length-1,t=0;if(I.current)for(;t<n&&e[t].start+e[t].size<r;)t+=1;else t=u(0,n,r,(function(r){return e[r].start}));for(var i=t,c=e[i].start;i<n&&c<r+q.current[U];)c+=e[i].size,i+=1;i=i===n?i:i-1,r=Math.max(t-h,0),c=Math.min(i+h,n);var o=e[r].start;return{oStart:r,oStop:c,vStart:t,vStop:i,innerMargin:o,innerSize:(n=Math[c<n?"max":"min"](e[c].end+e[c].size,e[n].end))-o}}),[h,U]),er=e.useCallback((function(r,e){void 0===e&&(e=!0),E.current&&(N.current=!1,y.current=e,E.current[X]=r)}),[X]),nr=e.useCallback((function(r,e){var n=(r=i(r)?{offset:r}:r).offset;if(r=r.smooth,i(n))if(r){var t=F.current,u=c();D.current=requestAnimationFrame((function r(){var o=V.current;o=i(o)?o:o(Math.abs(n-t)),o=Math.min((c()-u)/o,1);var a=_.current(o);er(a*(n-t)+t),1>o?D.current=requestAnimationFrame(r):e&&e()}))}else er(n),e&&e()}),[V,_,er]),tr=e.useCallback((function(r,e,t){var u=i(r)?{index:r}:r,c=u.index,o=u.align;if(o=void 0===o?n.auto:o,u=u.smooth,i(c)){k.current=!0,I.current&&$();var a=j.current,s=a[Math.max(0,Math.min(c,a.length-1))];if(s){c=s.start;var f=s.end;s=s.size,a=a[a.length-1].end;var l=q.current[U],d=F.current;a<=l?e&&e():(t||o===n.start||o===n.auto&&d+l>f&&d>c?d=a-c<=l?a-l:c:o===n.end||o===n.auto&&d+l<f&&d<c?d=c+s<=l?0:c-l+s:o===n.center&&c+s/2>l/2&&(d=a-(o=c-l/2+s/2)<=l?a-l:o),I.current&&1>=Math.abs(d-F.current)?e&&e():nr({offset:d,smooth:u},(function(){I.current?t?requestAnimationFrame((function(){return tr(r,e,t)})):setTimeout((function(){return tr(r,e)})):e&&e()})))}}}),[$,nr,U]);f=e.useCallback((function(r,e){return tr(r,e)}),[tr]),r=e.useCallback((function(r,e){return tr(r,e,!0)}),[tr]),v=function(r,n){var t=e.useRef(),u=o(r),i=e.useCallback((function(){t.current&&(cancelAnimationFrame(t.current),t.current=void 0)}),[]),a=e.useCallback((function(r){c()-r>=n?u.current():t.current=requestAnimationFrame((function(){return a(r)}))}),[u,n]);return[e.useCallback((function(){i(),a(c())}),[i,a]),i]}((function(){return cr(F.current)}),150);var ur=v[0],ir=v[1],cr=e.useCallback((function(r,e,n){if(!G.current||C.current||B.current&&B.current(0)||G.current({startIndex:0,stopIndex:S-1,loadIndex:0,scrollOffset:r,userScroll:!1}),t){var i=rr(r),c=i.oStart,o=i.oStop,a=i.vStart,s=i.vStop,f=i.innerMargin,l=i.innerSize,d=[],v=Array.isArray(P.current)?P.current:[];i=function(t){var u=j.current,i=u[t],c=i.start,o=i.size;d.push({index:t,start:c-f,size:o,width:q.current.width,isScrolling:n||void 0,isSticky:v.includes(t)||void 0,measureRef:function(i){i&&new ResizeObserver((function(i,a){var s,f,l,d=(i=i[0].target).getBoundingClientRect()[U];if(d){var v=null!=(s=null==(f=u[t-1])?void 0:f.end)?s:0;d===o&&c===v||(t<T.current&&c<r&&er(r+d-o,!1),j.current[t]=Z(t,d),k.current||cr(F.current,e,n),I.current=!0),T.current=t,null==(l=A.current.get(i))||l.disconnect(),A.current.set(i,a)}else a.disconnect(),A.current.delete(i)})).observe(i)}})};for(var h=c;h<=o;h+=1)i(h);v.length&&(c>(i=v[u(0,v.length-1,a,(function(r){return v[r]}))])&&(h=j.current[i].size,d.unshift({index:i,start:0,size:h,width:q.current.width,isScrolling:n||void 0,isSticky:!0,measureRef:function(){return null}}),f-=h,l+=h)),z((function(r){return function(r,e,n){if(r.length!==e.length)return!0;for(var t=function(t){if(Object.keys(r[t]).some((function(u){return!n[u]&&r[t][u]!==e[t][u]})))return{v:!0}},u=0;u<r.length;u+=1){var i=t(u);if("object"==typeof i)return i.v}return!1}(r.items,d,{measureRef:!0})?{items:d,innerMargin:f,innerSize:l}:r})),e&&(i=r>F.current,K.current&&K.current({overscanStartIndex:c,overscanStopIndex:o,visibleStartIndex:a,visibleStopIndex:s,scrollOffset:r,scrollForward:i,userScroll:N.current}),o=(c=Math.max(Math.floor((s+1)/S)-(i?0:1),0))*S,!G.current||s===O.current||B.current&&B.current(c)||G.current({startIndex:o,stopIndex:o+S-1,loadIndex:c,scrollOffset:r,userScroll:N.current}),n&&ur(),O.current=s)}else z({items:[]})}),[P,rr,Z,t,S,G,K,ur,er,U,B]);return function(r,e,n){var t=o(e);a((function(){if(null==r||!r.current)return function(){return null};var e=new ResizeObserver((function(r){r=r[0].contentRect,t.current({width:r.width,height:r.height})}));return e.observe(r.current),function(){return e.disconnect()}}),[t,r].concat(n))}(E,(function(r){var e,n=q.current,u=n.height;u=(n=n.width===r.width)&&u===r.height;var i=j.current.length,c=null==(e=j.current[i-1])?void 0:e.end;if(q.current=r,$(I.current),cr(F.current),d&&t!==i&&setTimeout((function(){return er(0,!1)})),C.current){var o;if(!I.current&&!n)e=null==(o=j.current[j.current.length-1])?void 0:o.end,er(F.current*(e/c||1),!1);!u&&Q.current&&Q.current(r)}else C.current=!0}),[t,d,cr,$,Q,er]),a((function(){L.current&&(i(w.innerMargin)&&(L.current.style[W]=w.innerMargin+"px"),i(w.innerSize)&&(L.current.style[U]=w.innerSize+"px"))}),[W,U,w.innerMargin,w.innerSize]),a((function(){var r=E.current;if(!r)return function(){return null};var e=function(r){if((r=r.target[X])!==F.current){var e=J.current;e="function"==typeof e?e(Math.abs(r-F.current)):e,cr(r,y.current,e),N.current=!0,y.current=!0,k.current=!1,F.current=r}};r.addEventListener("scroll",e,{passive:!0});var n=A.current;return function(){ir(),D.current&&(cancelAnimationFrame(D.current),D.current=void 0),r.removeEventListener("scroll",e),n.forEach((function(r){return r.disconnect()})),n.clear()}}),[ir,cr,X,J]),{outerRef:E,innerRef:L,items:w.items,scrollTo:nr,scrollToItem:f,startItem:r}},Object.defineProperty(r,"__esModule",{value:!0})}));
//# sourceMappingURL=index.umd.production.min.js.map
