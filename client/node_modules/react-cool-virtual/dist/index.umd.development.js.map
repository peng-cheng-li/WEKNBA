{"version":3,"file":"index.umd.development.js","sources":["../src/types/index.ts","../src/utils/findNearestBinarySearch.ts","../src/utils/isNumber.ts","../src/utils/now.ts","../src/utils/shouldUpdate.ts","../src/utils/useLatest.ts","../src/utils/useDebounce.ts","../src/utils/useIsoLayoutEffect.ts","../src/utils/useResizeEffect.ts","../src/useVirtual.ts"],"sourcesContent":["import { MutableRefObject, RefCallback } from \"react\";\n\n// Internal\nexport interface State {\n  items: Item[];\n  innerMargin?: number;\n  innerSize?: number;\n}\n\nexport interface Measure {\n  idx: number;\n  start: number;\n  end: number;\n  size: number;\n}\n\n// External\nexport type SsrItemCount = number | [number, number];\n\ntype UseIsScrolling = boolean | ((speed: number) => boolean);\n\nexport type ItemSize = number | ((index: number, width: number) => number);\n\ntype ScrollDuration = number | ((distance: number) => number);\n\ninterface ScrollEasingFunction {\n  (time: number): number;\n}\n\ninterface IsItemLoaded {\n  (index: number): boolean;\n}\n\ninterface LoadMore {\n  (event: {\n    startIndex: number;\n    stopIndex: number;\n    loadIndex: number;\n    readonly scrollOffset: number;\n    readonly userScroll: boolean;\n  }): void;\n}\n\ninterface OnScroll {\n  (event: {\n    overscanStartIndex: number;\n    overscanStopIndex: number;\n    visibleStartIndex: number;\n    visibleStopIndex: number;\n    readonly scrollOffset: number;\n    readonly scrollForward: boolean;\n    readonly userScroll: boolean;\n  }): void;\n}\n\nexport interface OnResizeEvent {\n  width: number;\n  height: number;\n}\n\nexport interface OnResize {\n  (event: OnResizeEvent): void;\n}\n\nexport interface Item {\n  readonly index: number;\n  readonly start: number;\n  readonly size: number;\n  readonly width: number;\n  readonly isScrolling?: true;\n  readonly isSticky?: true;\n  measureRef: RefCallback<HTMLElement>;\n}\n\nexport interface ScrollToOptions {\n  offset: number;\n  smooth?: boolean;\n}\n\nexport interface ScrollTo {\n  (value: number | ScrollToOptions, callback?: () => void): void;\n}\n\nexport enum Align {\n  auto = \"auto\",\n  start = \"start\",\n  center = \"center\",\n  end = \"end\",\n}\n\nexport interface ScrollToItemOptions {\n  index: number;\n  align?: Align;\n  smooth?: boolean;\n}\n\nexport interface ScrollToItem {\n  (index: number | ScrollToItemOptions, callback?: () => void): void;\n}\n\nexport interface StartItem {\n  (index: number, callback?: () => void): void;\n}\n\nexport interface Options {\n  itemCount: number;\n  ssrItemCount?: SsrItemCount;\n  itemSize?: ItemSize;\n  horizontal?: boolean;\n  resetScroll?: boolean;\n  overscanCount?: number;\n  useIsScrolling?: UseIsScrolling;\n  stickyIndices?: number[];\n  scrollDuration?: ScrollDuration;\n  scrollEasingFunction?: ScrollEasingFunction;\n  loadMoreCount?: number;\n  isItemLoaded?: IsItemLoaded;\n  loadMore?: LoadMore;\n  onScroll?: OnScroll;\n  onResize?: OnResize;\n}\n\nexport interface Return<O = any, I = any> {\n  outerRef: MutableRefObject<O | null>;\n  innerRef: MutableRefObject<I | null>;\n  items: Item[];\n  scrollTo: ScrollTo;\n  scrollToItem: ScrollToItem;\n  startItem: StartItem;\n}\n","export default (\n  low: number,\n  high: number,\n  input: number,\n  getVal: (idx: number) => number\n): number => {\n  while (low <= high) {\n    const mid = ((low + high) / 2) | 0;\n    const val = getVal(mid);\n\n    if (input < val) {\n      high = mid - 1;\n    } else if (input > val) {\n      low = mid + 1;\n    } else {\n      return mid;\n    }\n  }\n\n  return low > 0 ? low - 1 : 0;\n};\n","export default (val: unknown): val is number =>\n  typeof val === \"number\" && !Number.isNaN(val);\n","export default (): number =>\n  // eslint-disable-next-line compat/compat\n  \"performance\" in window ? performance.now() : Date.now();\n","import { Item } from \"../types\";\n\nexport default (\n  prev: Item[],\n  next: Item[],\n  skip: Record<string, boolean>\n): boolean => {\n  if (prev.length !== next.length) return true;\n\n  for (let i = 0; i < prev.length; i += 1)\n    if (\n      Object.keys(prev[i]).some((key) => {\n        const k = key as keyof Item;\n        return !skip[k] && prev[i][k] !== next[i][k];\n      })\n    )\n      return true;\n\n  return false;\n};\n","import { MutableRefObject, useRef } from \"react\";\n\nexport default <T>(val: T): MutableRefObject<T> => {\n  const ref = useRef(val);\n  ref.current = val;\n  return ref;\n};\n","import { useCallback, useRef } from \"react\";\n\nimport now from \"./now\";\nimport useLatest from \"./useLatest\";\n\ninterface Fn {\n  (): void;\n}\n\nexport default (cb: Fn, delay: number): [Fn, Fn] => {\n  const rafRef = useRef<number>();\n  const cbRef = useLatest(cb);\n\n  const cancel = useCallback(() => {\n    if (rafRef.current) {\n      cancelAnimationFrame(rafRef.current);\n      rafRef.current = undefined;\n    }\n  }, []);\n\n  const tick = useCallback(\n    (start: number) => {\n      if (now() - start >= delay) {\n        cbRef.current();\n      } else {\n        rafRef.current = requestAnimationFrame(() => tick(start));\n      }\n    },\n    [cbRef, delay]\n  );\n\n  const fn = useCallback(() => {\n    cancel();\n    tick(now());\n  }, [cancel, tick]);\n\n  return [fn, cancel];\n};\n","import { useEffect, useLayoutEffect } from \"react\";\n\nexport default typeof window !== \"undefined\" ? useLayoutEffect : useEffect;\n","import { DependencyList, RefObject } from \"react\";\n\nimport { OnResize } from \"../types\";\nimport useIsoLayoutEffect from \"./useIsoLayoutEffect\";\nimport useLatest from \"./useLatest\";\n\nexport default <T extends HTMLElement>(\n  ref: RefObject<T>,\n  cb: OnResize,\n  deps: DependencyList\n): void => {\n  const cbRef = useLatest(cb);\n\n  useIsoLayoutEffect(() => {\n    if (!ref?.current) return () => null;\n\n    // eslint-disable-next-line compat/compat\n    const observer = new ResizeObserver(([{ contentRect }]) => {\n      const { width, height } = contentRect;\n      cbRef.current({ width, height });\n    });\n\n    observer.observe(ref.current);\n\n    return () => observer.disconnect();\n  }, [cbRef, ref, ...deps]);\n};\n","import { useCallback, useRef, useState } from \"react\";\n\nimport {\n  Align,\n  Item,\n  ItemSize,\n  Measure,\n  Options,\n  Return,\n  ScrollTo,\n  ScrollToOptions,\n  ScrollToItem,\n  ScrollToItemOptions,\n  SsrItemCount,\n  StartItem,\n  State,\n} from \"./types\";\nimport {\n  findNearestBinarySearch,\n  isNumber,\n  now,\n  shouldUpdate,\n  useDebounce,\n  useIsoLayoutEffect,\n  useLatest,\n  useResizeEffect,\n} from \"./utils\";\n\nconst getInitState = (itemSize: ItemSize, ssrItemCount: SsrItemCount = 0) => {\n  const [idx, len] = isNumber(ssrItemCount)\n    ? [0, ssrItemCount - 1]\n    : ssrItemCount;\n  const items = [];\n\n  for (let i = idx; i <= len; i += 1)\n    items.push({\n      index: i,\n      start: 0,\n      width: 0,\n      size: isNumber(itemSize) ? itemSize : itemSize(i, 0),\n      measureRef: /* istanbul ignore next */ () => null,\n    });\n\n  return { items };\n};\n\nexport default <\n  O extends HTMLElement = HTMLElement,\n  I extends HTMLElement = O\n>({\n  itemCount,\n  ssrItemCount,\n  itemSize = 50,\n  horizontal,\n  resetScroll,\n  overscanCount = 1,\n  useIsScrolling,\n  stickyIndices,\n  // Default = 100ms <= distance * 0.75 <= 500ms\n  scrollDuration = (d) => Math.min(Math.max(d * 0.075, 100), 500),\n  // Default = easeInOutSine\n  scrollEasingFunction = (t) => -(Math.cos(Math.PI * t) - 1) / 2,\n  loadMoreCount = 15,\n  isItemLoaded,\n  loadMore,\n  onScroll,\n  onResize,\n}: Options): Return<O, I> => {\n  const [state, setState] = useState<State>(() =>\n    getInitState(itemSize, ssrItemCount)\n  );\n  const isMountedRef = useRef(false);\n  const isScrollingRef = useRef(true);\n  const isScrollToItemRef = useRef(false);\n  const hasDynamicSizeRef = useRef(false);\n  const rosRef = useRef<Map<Element, ResizeObserver>>(new Map());\n  const scrollOffsetRef = useRef(0);\n  const prevItemIdxRef = useRef(-1);\n  const prevVStopRef = useRef(-1);\n  const outerRef = useRef<O>(null);\n  const innerRef = useRef<I>(null);\n  const outerRectRef = useRef({ width: 0, height: 0 });\n  const msDataRef = useRef<Measure[]>([]);\n  const userScrollRef = useRef(true);\n  const scrollToRafRef = useRef<number>();\n  const stickyIndicesRef = useLatest(stickyIndices);\n  const durationRef = useLatest(scrollDuration);\n  const easingFnRef = useLatest(scrollEasingFunction);\n  const isItemLoadedRef = useLatest(isItemLoaded);\n  const loadMoreRef = useLatest(loadMore);\n  const itemSizeRef = useLatest(itemSize);\n  const useIsScrollingRef = useLatest(useIsScrolling);\n  const onScrollRef = useLatest(onScroll);\n  const onResizeRef = useLatest(onResize);\n  const sizeKey = !horizontal ? \"height\" : \"width\";\n  const marginKey = !horizontal ? \"marginTop\" : \"marginLeft\";\n  const scrollKey = !horizontal ? \"scrollTop\" : \"scrollLeft\";\n\n  const getItemSize = useCallback(\n    (idx: number) => {\n      const { current: size } = itemSizeRef;\n      return isNumber(size) ? size : size(idx, outerRectRef.current.width);\n    },\n    [itemSizeRef]\n  );\n\n  const getMeasure = useCallback((idx: number, size: number): Measure => {\n    const start = msDataRef.current[idx - 1]?.end ?? 0;\n    return { idx, start, end: start + size, size };\n  }, []);\n\n  const measureItems = useCallback(\n    (useCache = true) => {\n      msDataRef.current.length = itemCount;\n\n      for (let i = 0; i < itemCount; i += 1)\n        msDataRef.current[i] = getMeasure(\n          i,\n          useCache && msDataRef.current[i]\n            ? msDataRef.current[i].size\n            : getItemSize(i)\n        );\n    },\n    [getItemSize, getMeasure, itemCount]\n  );\n\n  const getCalcData = useCallback(\n    (scrollOffset: number) => {\n      const { current: msData } = msDataRef;\n      const lastIdx = msData.length - 1;\n      let vStart = 0;\n\n      if (hasDynamicSizeRef.current) {\n        while (\n          vStart < lastIdx &&\n          msData[vStart].start + msData[vStart].size < scrollOffset\n        )\n          vStart += 1;\n      } else {\n        vStart = findNearestBinarySearch(\n          0,\n          lastIdx,\n          scrollOffset,\n          (idx) => msData[idx].start\n        );\n      }\n\n      let vStop = vStart;\n      let currStart = msData[vStop].start;\n\n      while (\n        vStop < lastIdx &&\n        currStart < scrollOffset + outerRectRef.current[sizeKey]\n      ) {\n        currStart += msData[vStop].size;\n        vStop += 1;\n      }\n\n      vStop = vStop === lastIdx ? vStop : vStop - 1;\n      const oStart = Math.max(vStart - overscanCount, 0);\n      const oStop = Math.min(vStop + overscanCount, lastIdx);\n      const innerMargin = msData[oStart].start;\n      const totalSize = Math[oStop < lastIdx ? \"max\" : \"min\"](\n        msData[oStop].end + msData[oStop].size,\n        msData[lastIdx].end\n      );\n\n      return {\n        oStart,\n        oStop,\n        vStart,\n        vStop,\n        innerMargin,\n        innerSize: totalSize - innerMargin,\n      };\n    },\n    [overscanCount, sizeKey]\n  );\n\n  const scrollTo = useCallback(\n    (offset: number, isScrolling = true) => {\n      if (outerRef.current) {\n        userScrollRef.current = false;\n        isScrollingRef.current = isScrolling;\n        outerRef.current[scrollKey] = offset;\n      }\n    },\n    [scrollKey]\n  );\n\n  const scrollToOffset = useCallback<ScrollTo>(\n    (val, cb) => {\n      const { offset, smooth }: ScrollToOptions = isNumber(val)\n        ? { offset: val }\n        : val;\n\n      if (!isNumber(offset)) return;\n\n      if (!smooth) {\n        scrollTo(offset);\n        if (cb) cb();\n\n        return;\n      }\n\n      const { current: prevOffset } = scrollOffsetRef;\n      const start = now();\n\n      const scroll = () => {\n        let { current: duration } = durationRef;\n        duration = isNumber(duration)\n          ? duration\n          : duration(Math.abs(offset - prevOffset));\n        const time = Math.min((now() - start) / duration, 1);\n        const easing = easingFnRef.current(time);\n\n        scrollTo(easing * (offset - prevOffset) + prevOffset);\n\n        if (time < 1) {\n          scrollToRafRef.current = requestAnimationFrame(scroll);\n        } else if (cb) {\n          cb();\n        }\n      };\n\n      scrollToRafRef.current = requestAnimationFrame(scroll);\n    },\n    [durationRef, easingFnRef, scrollTo]\n  );\n\n  const scrollToIndex = useCallback(\n    (\n      val: Parameters<ScrollToItem>[0],\n      cb: Parameters<ScrollToItem>[1],\n      isSync?: boolean\n    ) => {\n      const {\n        index,\n        align = Align.auto,\n        smooth,\n      }: ScrollToItemOptions = isNumber(val) ? { index: val } : val;\n\n      if (!isNumber(index)) return;\n\n      isScrollToItemRef.current = true;\n\n      // For dynamic size, we must measure it for getting the correct scroll position\n      if (hasDynamicSizeRef.current) measureItems();\n\n      const { current: msData } = msDataRef;\n      const ms = msData[Math.max(0, Math.min(index, msData.length - 1))];\n\n      if (!ms) return;\n\n      const { start, end, size } = ms;\n      const totalSize = msData[msData.length - 1].end;\n      const outerSize = outerRectRef.current[sizeKey];\n      let { current: scrollOffset } = scrollOffsetRef;\n\n      if (totalSize <= outerSize) {\n        if (cb) cb();\n        return;\n      }\n\n      if (\n        isSync ||\n        align === Align.start ||\n        (align === Align.auto &&\n          scrollOffset + outerSize > end &&\n          scrollOffset > start)\n      ) {\n        scrollOffset =\n          totalSize - start <= outerSize ? totalSize - outerSize : start;\n      } else if (\n        align === Align.end ||\n        (align === Align.auto &&\n          scrollOffset + outerSize < end &&\n          scrollOffset < start)\n      ) {\n        scrollOffset = start + size <= outerSize ? 0 : start - outerSize + size;\n      } else if (align === Align.center && start + size / 2 > outerSize / 2) {\n        const to = start - outerSize / 2 + size / 2;\n        scrollOffset = totalSize - to <= outerSize ? totalSize - outerSize : to;\n      }\n\n      if (\n        hasDynamicSizeRef.current &&\n        Math.abs(scrollOffset - scrollOffsetRef.current) <= 1\n      ) {\n        if (cb) cb();\n        return;\n      }\n\n      scrollToOffset({ offset: scrollOffset, smooth }, () => {\n        if (!hasDynamicSizeRef.current) {\n          if (cb) cb();\n        } else if (isSync) {\n          requestAnimationFrame(() => scrollToIndex(val, cb, isSync));\n        } else {\n          setTimeout(() => scrollToIndex(val, cb));\n        }\n      });\n    },\n    [measureItems, scrollToOffset, sizeKey]\n  );\n\n  const scrollToItem = useCallback<ScrollToItem>(\n    (val, cb) => scrollToIndex(val, cb),\n    [scrollToIndex]\n  );\n\n  const startItem = useCallback<StartItem>(\n    (idx, cb) => scrollToIndex(idx, cb, true),\n    [scrollToIndex]\n  );\n\n  const [resetIsScrolling, cancelResetIsScrolling] = useDebounce(\n    // eslint-disable-next-line @typescript-eslint/no-use-before-define\n    () => handleScroll(scrollOffsetRef.current),\n    150\n  );\n\n  const handleScroll = useCallback(\n    (scrollOffset: number, isScrolling?: boolean, uxScrolling?: boolean) => {\n      if (\n        loadMoreRef.current &&\n        !isMountedRef.current &&\n        !(isItemLoadedRef.current && isItemLoadedRef.current(0))\n      )\n        loadMoreRef.current({\n          startIndex: 0,\n          stopIndex: loadMoreCount - 1,\n          loadIndex: 0,\n          scrollOffset,\n          userScroll: false,\n        });\n\n      if (!itemCount) {\n        setState({ items: [] });\n        return;\n      }\n\n      const calcData = getCalcData(scrollOffset);\n      const { oStart, oStop, vStart, vStop } = calcData;\n      let { innerMargin, innerSize } = calcData;\n      const items: Item[] = [];\n      const stickies = Array.isArray(stickyIndicesRef.current)\n        ? stickyIndicesRef.current\n        : [];\n\n      for (let i = oStart; i <= oStop; i += 1) {\n        const { current: msData } = msDataRef;\n        const { start, size } = msData[i];\n\n        items.push({\n          index: i,\n          start: start - innerMargin,\n          size,\n          width: outerRectRef.current.width,\n          isScrolling: uxScrolling || undefined,\n          isSticky: stickies.includes(i) || undefined,\n          measureRef: (el) => {\n            if (!el) return;\n\n            // eslint-disable-next-line compat/compat\n            new ResizeObserver(([{ target }], ro) => {\n              // NOTE: Use `borderBoxSize` when it's supported by Safari\n              // see: https://caniuse.com/mdn-api_resizeobserverentry_borderboxsize\n              const measuredSize = target.getBoundingClientRect()[sizeKey];\n\n              if (!measuredSize) {\n                ro.disconnect();\n                rosRef.current.delete(target);\n                return;\n              }\n\n              const prevEnd = msData[i - 1]?.end ?? 0;\n\n              if (measuredSize !== size || start !== prevEnd) {\n                // To prevent dynamic size from jumping during backward scrolling\n                if (i < prevItemIdxRef.current && start < scrollOffset)\n                  scrollTo(scrollOffset + measuredSize - size, false);\n\n                msDataRef.current[i] = getMeasure(i, measuredSize);\n                if (!isScrollToItemRef.current)\n                  handleScroll(\n                    scrollOffsetRef.current,\n                    isScrolling,\n                    uxScrolling\n                  );\n\n                hasDynamicSizeRef.current = true;\n              }\n\n              prevItemIdxRef.current = i;\n\n              rosRef.current.get(target)?.disconnect();\n              rosRef.current.set(target, ro);\n            }).observe(el);\n          },\n        });\n      }\n\n      if (stickies.length) {\n        const stickyIdx =\n          stickies[\n            findNearestBinarySearch(\n              0,\n              stickies.length - 1,\n              vStart,\n              (idx) => stickies[idx]\n            )\n          ];\n\n        if (oStart > stickyIdx) {\n          const { size } = msDataRef.current[stickyIdx];\n\n          items.unshift({\n            index: stickyIdx,\n            start: 0,\n            size,\n            width: outerRectRef.current.width,\n            isScrolling: uxScrolling || undefined,\n            isSticky: true,\n            measureRef: /* istanbul ignore next */ () => null,\n          });\n\n          innerMargin -= size;\n          innerSize += size;\n        }\n      }\n\n      setState((prevState) =>\n        shouldUpdate(prevState.items, items, { measureRef: true })\n          ? { items, innerMargin, innerSize }\n          : prevState\n      );\n\n      if (!isScrolling) return;\n\n      const scrollForward = scrollOffset > scrollOffsetRef.current;\n\n      if (onScrollRef.current)\n        onScrollRef.current({\n          overscanStartIndex: oStart,\n          overscanStopIndex: oStop,\n          visibleStartIndex: vStart,\n          visibleStopIndex: vStop,\n          scrollOffset,\n          scrollForward,\n          userScroll: userScrollRef.current,\n        });\n\n      const loadIndex = Math.max(\n        Math.floor((vStop + 1) / loadMoreCount) - (scrollForward ? 0 : 1),\n        0\n      );\n      const startIndex = loadIndex * loadMoreCount;\n\n      if (\n        loadMoreRef.current &&\n        vStop !== prevVStopRef.current &&\n        !(isItemLoadedRef.current && isItemLoadedRef.current(loadIndex))\n      )\n        loadMoreRef.current({\n          startIndex,\n          stopIndex: startIndex + loadMoreCount - 1,\n          loadIndex,\n          scrollOffset,\n          userScroll: userScrollRef.current,\n        });\n\n      if (uxScrolling) resetIsScrolling();\n\n      prevVStopRef.current = vStop;\n    },\n    [\n      stickyIndicesRef,\n      getCalcData,\n      getMeasure,\n      itemCount,\n      loadMoreCount,\n      loadMoreRef,\n      onScrollRef,\n      resetIsScrolling,\n      scrollTo,\n      sizeKey,\n      isItemLoadedRef,\n    ]\n  );\n\n  useResizeEffect<O>(\n    outerRef,\n    (rect) => {\n      const { width, height } = outerRectRef.current;\n      const isSameWidth = width === rect.width;\n      const isSameSize = isSameWidth && height === rect.height;\n      const msDataLen = msDataRef.current.length;\n      const prevTotalSize = msDataRef.current[msDataLen - 1]?.end;\n\n      outerRectRef.current = rect;\n      measureItems(hasDynamicSizeRef.current);\n      handleScroll(scrollOffsetRef.current);\n\n      if (resetScroll && itemCount !== msDataLen)\n        setTimeout(() => scrollTo(0, false));\n\n      if (!isMountedRef.current) {\n        isMountedRef.current = true;\n        return;\n      }\n\n      if (!hasDynamicSizeRef.current && !isSameWidth) {\n        const totalSize = msDataRef.current[msDataRef.current.length - 1]?.end;\n        const ratio = totalSize / prevTotalSize || 1;\n\n        scrollTo(scrollOffsetRef.current * ratio, false);\n      }\n\n      if (!isSameSize && onResizeRef.current) onResizeRef.current(rect);\n    },\n    [itemCount, resetScroll, handleScroll, measureItems, onResizeRef, scrollTo]\n  );\n\n  useIsoLayoutEffect(() => {\n    if (!innerRef.current) return;\n\n    if (isNumber(state.innerMargin))\n      innerRef.current.style[marginKey] = `${state.innerMargin}px`;\n    if (isNumber(state.innerSize))\n      innerRef.current.style[sizeKey] = `${state.innerSize}px`;\n  }, [marginKey, sizeKey, state.innerMargin, state.innerSize]);\n\n  useIsoLayoutEffect(() => {\n    const { current: outer } = outerRef;\n\n    if (!outer) return () => null;\n\n    const scrollHandler = ({ target }: Event) => {\n      const scrollOffset = (target as O)[scrollKey];\n\n      if (scrollOffset === scrollOffsetRef.current) return;\n\n      let { current: uxScrolling } = useIsScrollingRef;\n      uxScrolling =\n        typeof uxScrolling === \"function\"\n          ? uxScrolling(Math.abs(scrollOffset - scrollOffsetRef.current))\n          : uxScrolling;\n\n      handleScroll(scrollOffset, isScrollingRef.current, uxScrolling);\n\n      userScrollRef.current = true;\n      isScrollingRef.current = true;\n      isScrollToItemRef.current = false;\n      scrollOffsetRef.current = scrollOffset;\n    };\n\n    outer.addEventListener(\"scroll\", scrollHandler, { passive: true });\n\n    const ros = rosRef.current;\n\n    return () => {\n      cancelResetIsScrolling();\n      if (scrollToRafRef.current) {\n        cancelAnimationFrame(scrollToRafRef.current);\n        scrollToRafRef.current = undefined;\n      }\n\n      outer.removeEventListener(\"scroll\", scrollHandler);\n\n      ros.forEach((ro) => ro.disconnect());\n      ros.clear();\n    };\n  }, [cancelResetIsScrolling, handleScroll, scrollKey, useIsScrollingRef]);\n\n  return {\n    outerRef,\n    innerRef,\n    items: state.items,\n    scrollTo: scrollToOffset,\n    scrollToItem,\n    startItem,\n  };\n};\n"],"names":["Align","low","high","input","getVal","mid","val","Number","isNaN","window","performance","now","Date","prev","next","skip","length","i","Object","keys","some","key","k","ref","useRef","current","cb","delay","rafRef","cbRef","useLatest","cancel","useCallback","cancelAnimationFrame","undefined","tick","start","requestAnimationFrame","fn","useLayoutEffect","useEffect","deps","useIsoLayoutEffect","observer","ResizeObserver","contentRect","width","height","observe","disconnect","getInitState","itemSize","ssrItemCount","isNumber","idx","len","items","push","index","size","measureRef","itemCount","horizontal","resetScroll","overscanCount","useIsScrolling","stickyIndices","scrollDuration","d","Math","min","max","scrollEasingFunction","t","cos","PI","loadMoreCount","isItemLoaded","loadMore","onScroll","onResize","useState","state","setState","isMountedRef","isScrollingRef","isScrollToItemRef","hasDynamicSizeRef","rosRef","Map","scrollOffsetRef","prevItemIdxRef","prevVStopRef","outerRef","innerRef","outerRectRef","msDataRef","userScrollRef","scrollToRafRef","stickyIndicesRef","durationRef","easingFnRef","isItemLoadedRef","loadMoreRef","itemSizeRef","useIsScrollingRef","onScrollRef","onResizeRef","sizeKey","marginKey","scrollKey","getItemSize","getMeasure","end","measureItems","useCache","getCalcData","scrollOffset","msData","lastIdx","vStart","findNearestBinarySearch","vStop","currStart","oStart","oStop","innerMargin","totalSize","innerSize","scrollTo","offset","isScrolling","scrollToOffset","smooth","prevOffset","scroll","duration","abs","time","easing","scrollToIndex","isSync","align","auto","ms","outerSize","center","to","setTimeout","scrollToItem","startItem","useDebounce","handleScroll","resetIsScrolling","cancelResetIsScrolling","uxScrolling","startIndex","stopIndex","loadIndex","userScroll","calcData","stickies","Array","isArray","isSticky","includes","el","ro","target","measuredSize","getBoundingClientRect","prevEnd","get","set","stickyIdx","unshift","prevState","shouldUpdate","scrollForward","overscanStartIndex","overscanStopIndex","visibleStartIndex","visibleStopIndex","floor","useResizeEffect","rect","isSameWidth","isSameSize","msDataLen","prevTotalSize","ratio","style","outer","scrollHandler","addEventListener","passive","ros","removeEventListener","forEach","clear"],"mappings":"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"}